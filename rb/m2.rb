# ctfの問題
# 与えられたパラメタ
n = 1517330236262917595314610888889322115651087080826711948897066340883208205571592392362650858571076247939805436226544833224526137582834770402681005343930059463684528957271778199162575053306238099823295117697031968370690372250916935800738698142103275969223264184374648246277564306900886005299731265812255274723175925185522344831066577166867786835955092059346244885587228196357297758371381557924676260190209536670230008561217008649261974735505203813478978893582292682827884118215872470401293272325715864815977064075988643101088355047954735427424641386870772845440782632933485165110172437511822736907550777817722248753671107339823410418938404382732079381329288400012929311347390423061254658780185245562668131009832293474920208834795460061115101364091252176594144096675899952570380792978037217747311595899301451192342027799533264325948876556110474850761538179748318187805312451895898751337975457949549497666542175077894987697085521882531938339334715190663665300179658557458036053188152532948734992896239950564081581184284728802682982779186068791931259198917308153082917381616147108543673346682338045309449569430550618884202465809290850964525390539782080230737593560891353558335337408957948041667929154230334506735825418239563481028126435029
p n.size
p = 34111525225922333955113751419357677129436029651245533697825114748126342624744832960936498161825269430327019858323450578875242014583535842110912370431931233957939950911741013017595977471949767235426490850284286661592357779825212265055931705799916913817655743434497422993498931394618832741336247426815710164342599150990608143637331068220244525541794855651643135012846039439355101027994945120698530177329829213208761057392236875366458197098507252851244132455996468628957560178868724310000317011912994632328371761486669358065577269198065792981537378448324923622959249447066754504943097391628716371245206444816309511381323
p p.size
q = 44481453884385518268018625442920628989497457642625668259648790876723318635861137128631112417617317160816537010595885992856520476731882382742220627466006460645416066646852266992087386855491152795237153901319521506429873434336969666536995399866125781057768075533560120399184566956433129854995464893265403724034960689938351450709950699740508459206785093693277541785285699733873530541918483842122691276322286810422297015782658645129421043160749040846216892671031156465364652681036828461619272427318758098538927727392459501761203842363017121432657534770898181975532066012149902177196510416802134121754859407938165610800223
p q.size
e = 6553
7
c = 225549592628492616152632265482125315868911125659971085929712296366214355608049224179339757637982541542745010822022226409126123627804953064072055667012172681551500780763483172914389813057444669314726404135978565446282309019729994976815925850916487257699707478206132474710963752590399332920672607440793116387051071191919835316845827838287954541558777355864714782464299278036910958484272003656702623646042688124964364376687297742060363382322519436200343894901785951095760714894439233966409337996138592489997024933882003852590408577812535049335652212448474376457015077047529818315877549614859586475504070051201054704954654093482056493092930700787890579346065916834434739980791402216175555075896066616519150164831990626727591876115821219941268309678240872298029611746575376322733311657394502859852213595389607239431585120943268774679785316133478171225719729917877009624611286702010936951705160870997184123775488592130586606070277173392647225589257616518666852404878425355285270687131724258281902727717116041282358028398978152480549468694659695121115046850718180640407034795656480263573773381753855724693739080045739160297875306923958599742379878734638341856117533253251168244471273520476474579680250862738227337561115160603373096699944163
p.size
# L = LCM(p-1,q-1)
l = (p-1).lcm(q-1)
#拡張ユークリッドの互除法
def extgcd_h(a, b, values)
  d = a
 
  if b.zero?
    values[:x] = 1
    values[:y] = 0
  else
    d = extgcd_h(b, a % b, values)
 
    x = values[:x]
    y = values[:y]
    values[:x] = y
    values[:y] = x - (a / b) * y
  end
  d
end
  
xy = {}
extgcd_h(e, l, xy)
d = xy[:x]
d += l if d < 0

#モジュラ演算をしながら、繰り返し二乗法を行う
def power(a, n,low)
  answer = 1; count = 0
  while n != 0
    if n % 2 == 1
      answer = (answer * a) % low; count += 1
    end
    a = (a*a)%low; count += 1
    n /= 2
  end
  return answer
end

p power(c,d,n)

x = 344354021406140222477048612097739082106926027702360235524645663798790109277448549239495101839907288162319210424052736893661780865135138137788068434816535962662071947745506412597320053423584729862888162919377008752119854092383262048948289551525682351451917558432289229613840194849963514247654785268546329637934812194183800081732005738527656674691246651534454702299113954369663150560329659902585796783486924837476455689835959556994360549920372317065462111654783966333666179011619501435745353879063957164242313338020250950980100985437157432863288604461407405042159223258490336983336885594314323751464018700130605002679978013376984950117350015986927691584857238471861477530418235095060111339794440275157409211282768069321122150086723204563542687829088189369614342908376611799728292862692908458062364209513881348385346114948756125758335868172941885143401646442731813038701671196118369672229529952004533506409671514795325024037609089374194379759375693054273904054494
283881262304419853912109653918823960812707489102885454984777601060469801461033414935049503193205010585718249048194024877042973282751878813141614748264725998530882799340308793781460414167524836997514014578648146003335755710312483525336675813664403826862288906043514570612816

p x.size
=begin
This is 4096bit RSA.
The flag is FLAG_NbZ6gQeKDMVFJMaU
PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING PADDING P
=end
